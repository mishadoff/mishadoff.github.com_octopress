<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: programming | mishadoff thoughts]]></title>
  <link href="http://mishadoff.github.com/blog/categories/programming/atom.xml" rel="self"/>
  <link href="http://mishadoff.github.com/"/>
  <updated>2013-02-22T02:08:59+02:00</updated>
  <id>http://mishadoff.github.com/</id>
  <author>
    <name><![CDATA[mishadoff]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Clojure Euler: Problem 015]]></title>
    <link href="http://mishadoff.github.com/blog/clojure-euler-problem-015/"/>
    <updated>2013-02-19T00:38:00+02:00</updated>
    <id>http://mishadoff.github.com/blog/clojure-euler-problem-015</id>
    <content type="html"><![CDATA[<blockquote>
  <p>Starting in the top left corner of a 2 x 2 grid, there are 6 routes
(without backtracking) to the bottom right corner.</p>

  <p>How many routes are there through a 20 x 20 grid?</p>
</blockquote>

<p>Permalink: <a href="http://projecteuler.net/problem=15">http://projecteuler.net/problem=15</a></p>

<!-- more -->

<p><img src="http://projecteuler.net/project/images/p_015.gif" alt="" /></p>

<p>Picture is always a huge help to find correct the solution.
Let’s see the pattern here, with another picture</p>

<p><em>Warning:</em> If you don’t understand art, don’t look at that picture.</p>

<p><img src="http://i.imgur.com/WNEQNxG.png" alt="" /></p>

<p>It’s a solution for 3 x 3 grid. We trying to process it by steps:</p>

<ul>
  <li>At the start we located at the top left corner <code>[0, 0]</code>. There is just one case
to be at the start so we put <code>1</code> to that point.</li>
  <li>Then we move either down <code>[1, 0]</code> or right <code>[0, 1]</code>, and we put <code>1</code>
on the edges of the second diagonal line.</li>
  <li>Obviously, the point <code>[1, 1]</code> we can reach either from <code>[0, 1]</code> or from <code>[1, 0]</code>,
so there are two routes, and so on.</li>
</ul>

<p>If you just output the numbers from each diagonal line you’ll get:</p>

<p>```
       1
      1 1
     1 2 1
    1 3 3 1</p>

<p>```</p>

<p>It’s famous <a href="http://en.wikipedia.org/wiki/Pascal%27s_triangle">Pascal’s triangle</a>.
Each element in this triangle obtained by sum of two closest elements from the upper row.</p>

<p>To get desired result we need to sum these numbers again, until we get one number.
But it’s also numbers from Pascal’s triangle.</p>

<p><code>
    1   3   3   1
      4   6   4
       10  10
         20
</code></p>

<p>We can treat Pascal’s triangle as a sequence, and each row is an element. Then the
following function calculates next row:</p>

<p><code>clojure
(defn routes-extend [lst]
  (let [size (count lst)]
    (for [i (range (inc size))]
      (if (or (= 0 i) (= size i)) 1
        (+ (nth lst (dec i)) (nth lst i))))))
</code></p>

<p>Usage:</p>

<p><code>
(routes-extend [1]) =&gt; [1 1]
(routes-extend [1 1]) =&gt; [1 2 1]
</code></p>

<p>Now we can build infinite sequence of Pascal’s triangle rows:</p>

<p><code>clojure
(iterate routes-extend [1])
</code></p>

<p>For <code>3 x 3</code> grid we had 7 diagonals, each of them represented one row.
Take a guess. For <code>n x n</code> grid we need to get <code>2 * n + 1</code> row. And take it
middle element, which, of course, will be with the index <code>n</code>.</p>

<p>That’s the final solution:</p>

<p><code>clojure
(let [n 20 d (inc (* n 2))]
  (nth (last (take d (iterate routes-extend [1]))) n))
</code></p>

<p>Problem solved.</p>

<p><a href="https://github.com/mishadoff/project-euler/blob/master/src/project_euler/problem015.clj">Code</a></p>

<p><strong>P.S</strong> Two points I want to admit here. First of all, drawing pictures
and trying to understand problem with pictures is a powerful technique that must be
used for every problem.</p>

<p>Second of all, you can see that our algorithm has complexity of <code>O(n^2)</code>. But ideal
solution is <code>O(1)</code> with usage <a href="http://en.wikipedia.org/wiki/Binomial_coefficient">binomial coefficient</a>
<code>(2*n, n)</code>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Standard ML]]></title>
    <link href="http://mishadoff.github.com/blog/standard-ml/"/>
    <updated>2013-02-16T13:33:00+02:00</updated>
    <id>http://mishadoff.github.com/blog/standard-ml</id>
    <content type="html"><![CDATA[<p>Last weekend I was hacking <a href="http://en.wikipedia.org/wiki/Standard_ML">Standard ML</a> a bit.</p>

<!-- more -->

<h3 id="coursera">Coursera</h3>

<p>There are excellent course on coursera called <a href="https://class.coursera.org/proglang-2012-001/class/index">Programming Languages</a></p>

<p>Currently, the first half is available, that explains basic and advanced functional programming constructions
with Standard ML as primary language. Later some idioms will be presented using
<strong>Racket</strong> and <strong>Ruby</strong> (<em>maybe, I will finally understand ruby</em>) so you can treat this course as introduction
to these languages. In fact, it teaches much more than “<em>how to code in XXX</em>”.</p>

<h3 id="tools">Tools</h3>

<p>For playing with ML you need <a href="http://www.smlnj.org/">SML/NJ</a> compiler and
<a href="http://www.smlnj.org/doc/Emacs/sml-mode.html">sml-mode</a> for emacs.</p>

<p><em>If you don’t have emacs installed, do it right now!</em></p>

<h3 id="play">Play</h3>

<p>Following snippets give you basic understanding of ML or
refresh your knowledge for syntax.</p>

<p>Print “Hello, world!”:</p>

<p><code>sml
fun print_hello_world () = print "Hello, world\n";
</code></p>

<p>Variables (<em>in fact, values</em>):</p>

<p><code>sml
val a = 38;
val b = a + 3;
val c = b + 1;
</code></p>

<p>Conditionals:</p>

<p><code>sml
val cond = if 5 &gt; 4 then 5 else 4
</code></p>

<p>Boolean operators have terrible names:</p>

<p><code>sml
val cond2 = if 5 &gt; 4 andalso 4 &gt; 5 then 5 else 7
</code></p>

<p>Function with one parameter:</p>

<p><code>sml
fun square x = x * x
</code></p>

<p>Function with more than one parameter:</p>

<p><code>sml
fun sum (x, y, z) = x + y + z
</code></p>

<p>Actually, it’s not three parameters, it’s one parameter - tuple:</p>

<p><code>sml
fun swap (x, y) = (y, x)
</code></p>

<p>To access tuple elements use hash-number, note you can specify tuple type:</p>

<p><code>sml
fun get_month (date : int * string * int) : string= (#2 date)
val month1 = get_month(2012, "January", 21);
</code></p>

<p>You can specify input types and return type, but ML is very clever. Almost always
it can detect correct type using <em>type inference</em> without explicit definition.</p>

<p><em>I don’t understand it! Explain, please</em>. Comments:</p>

<p><code>sml
(* Operation '*' defined for int types, so this function has type int -&gt; int *)
fun cube x = x * x * x
</code></p>

<p>There is records. It’s like named tuples.</p>

<p><code>sml
fun get_month_real ({year, month, day}) = month
val month2 = get_month_real({year=2012, month="January", day=21});
</code></p>

<p>Using <code>let</code> form we can define new lexical scope:</p>

<p><code>sml
fun add3 x =
    let
        val num = 3
    in
        x + 3
    end
</code></p>

<p>This leads to closures (<em>function + context</em>):</p>

<p><code>sml
fun add3 x =
    let
        val num = 3
        fun add_to x = x + num
    in
        add_to x
    end
</code></p>

<p>Function <code>add_to</code> capture <code>num</code> value from context.</p>

<p>By the way functions are first-class objects and values also,
so we can assign one function to another:</p>

<p><code>sml
val another_cube = cube
</code></p>

<p>Function composition becomes a piece of cake:</p>

<p><code>sml
val cube_and_cube = cube o cube
</code></p>

<p>We even can pass function as a parameter:</p>

<p><code>sml
fun binary_apply (f, x, y) = f (x, y)
binary_apply(swap, 1, 2);
</code></p>

<p>We don’t forced to provide function name, we can use lambdas:</p>

<p><code>sml
binary_apply(fn (x, y) =&gt; x * y, 23, 46)
</code></p>

<p>This helps us easily implement such useful functions as <code>map</code>, <code>reduce</code> and <code>filter</code>.
But they are already available in
<a href="http://www.standardml.org/Basis/manpages.html">Standard ML Basis Library</a></p>

<p>Another great feature is <em>pattern-matching</em>. Here is factorial function</p>

<p><code>sml
fun factorial x =
    case x of
        0 =&gt; 1
      | _ =&gt; x * factorial(x - 1)
</code></p>

<p>or list concatenation</p>

<p><code>sml
fun concat (x, y) =
    case x of
        [] =&gt; y
      | x::xs =&gt; x::concat(xs, y)
</code></p>

<p>Honestly, it’s just baby examples of pattern matching. In fact, it is much more
powerful.</p>

<p>And the last thing I wanted to show is datatypes:</p>

<p>To define a list:</p>

<p><code>sml
datatype 'a list = EMPTY | CONS of 'a * 'a list
</code></p>

<p>To create that list:</p>

<p><code>sml
val list = CONS(1, CONS(2, CONS(3, EMPTY)))
</code></p>

<p>That’s very small part of all that can be done in ML. There are also a lot of useful
constructs and idioms that not covered: type synonyms, polymorphic types,
equality types, tail recursion, mutual recursion, function wrapping,
currying, partial application, advanced pattern matching, signatures,
modules and lot more.</p>

<p>If you really interested you will find a lot of these terms exciting.</p>

<p>Full code is available on
<a href="https://github.com/mishadoff/prog-experiment/blob/master/sml/play.sml">github</a></p>

<h3 id="impressions">Impressions</h3>

<p>ML is a great language. Perhaps, it is not so great as Java in enterprise, and not
so great as Clojure in rapid prototyping, but it’s worth to devote
few days for ML basics. It really improve your dev skills and maybe made your
<em>Factories</em>, <em>Bridges</em> and <em>Proxies</em> better.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Clojure Euler: Problem 014]]></title>
    <link href="http://mishadoff.github.com/blog/clojure-euler-problem-014/"/>
    <updated>2013-02-16T01:08:00+02:00</updated>
    <id>http://mishadoff.github.com/blog/clojure-euler-problem-014</id>
    <content type="html"><![CDATA[<blockquote>
  <p>Which starting number, under one million, produces the longest Collatz chain?</p>
</blockquote>

<p>Permalink: <a href="http://projecteuler.net/problem=14">http://projecteuler.net/problem=14</a></p>

<!-- more -->

<blockquote>
  <p>The following iterative sequence is defined for the set of positive integers:</p>

  <p>n → n/2 (n is even)</p>

  <p>n → 3n + 1 (n is odd)</p>

  <p>Using the rule above and starting with 13, we generate the following sequence:</p>

  <p>13 → 40 → 20 → 10 → 5 → 16 → 8 → 4 → 2 → 1</p>

  <p>It can be seen that this sequence (starting at 13 and finishing at 1)
contains 10 terms. Although it has not been proved yet (Collatz Problem),
it is thought that all starting numbers finish at 1.</p>

  <p>Which starting number, under one million, produces the longest chain?</p>

  <p>NOTE: Once the chain starts the terms are allowed to go above one million.</p>
</blockquote>

<p>Sequences again.
So, first of all we need function to detect next collatz number.
It is pretty straightforward:</p>

<p><code>clojure
(defn collatz-next [n]
  (if (even? n) (/ n 2) (inc (* n 3))))
</code></p>

<p>Using this <em>next-element-generator</em> we can generate infinite collatz sequence,
starting from number <code>n</code>:</p>

<p><code>clojure
(iterate collatz-next n)
</code></p>

<p>But instead of infinite sequence, we stop processing when we reach <code>1</code> and calculate
count of collatz chain sequence:</p>

<p><code>clojure
(defn collatz-chain-length [n]
  (inc (count (take-while #(&gt; % 1) (iterate collatz-next n)))))
</code></p>

<p>Now we have almost all code logic and just use it: calculate collatz chain
for all numbers in range <code>[1..1000000]</code>, find maximum and output its index:</p>

<p><code>clojure
(first (reduce #(if (&gt; (second %1) (second %2)) %1 %2)
               (map #(list % (collatz-chain-length %)) (range 1 1000000))))
</code></p>

<p>Run it. Wait a minute. I mean minute <em>literally</em>.</p>

<p>The time of caclulation is slightly greater than <strong>one minute</strong> on my machine,
and I have no idea how to solve it another way.</p>

<p>I am sure there is a better algorithm than mine. But I don’t know it.
What I know is try to re-read problem definion if you are stuck. Especially that part:</p>

<blockquote>
  <p>13 → 40 → 20 → 10 → 5 → 16 → 8 → 4 → 2 → 1</p>
</blockquote>

<p>So, for <code>13</code> the chain length is <code>10</code>, for <code>40</code> is <code>9</code>, for <code>20</code> is <code>8</code>,…</p>

<p>Got it?</p>

<p>Each time we calculate length we perform <em>repeated calculation</em>. If we know
chain length of <code>13</code>, and whole its path to <code>1</code> we don’t need to calculate length
for <code>40</code>, <code>20</code> and so on.</p>

<p>So the optimization is <em>somehow to cache the results</em>. But at first we need to rewrite
it to have recursive solution.</p>

<p>Here the first (<em>and final</em>) version:</p>

<p><code>clojure
(defn collatz-chain-recursive [n]
  (if (= n 1) 1
      (inc (collatz-chain-recursive (collatz-next n)))))
</code></p>

<p>Recursion is impressive at the point that its implementation
almost exactly follows the problem definition. It is easy to understand.</p>

<p>But, as you may notice our implementation not
<a href="http://en.wikipedia.org/wiki/Tail_call">tail-recursive</a> so we can
have troubles. Do not think about it unless we actually have them.</p>

<p>For the sake of fun let’s run this function instead of previous to
obtain the results.</p>

<p><strong>20 seconds</strong>, it is great. I even don’t think that
this simple recursive function gives such boost in performance.</p>

<p>One little tweak in result function:</p>

<p><code>clojure
(first
  (apply max-key second
         (map #(list % (collatz-chain-recursive %)) (range 1 1000000))))
</code></p>

<p>And we have <strong>~12 seconds</strong>.</p>

<p>Unexpected “The End”. Yeah, I love The Doors.</p>

<p><a href="https://github.com/mishadoff/project-euler/blob/master/src/project_euler/problem014.clj">code-code</a></p>

<p><strong>P.S.</strong> I really wanted to explain technique called
<a href="http://en.wikipedia.org/wiki/Memoization">memoization</a> and
simple clojure function <a href="http://clojuredocs.org/clojure_core/clojure.core/memoize">memoize</a>,
but seems that caching result doesn’t have much sense here because
12 seconds is acceptable. We will have chance to introduce
memoization later, where it will be more useful. By the way, I am <em>lazy</em>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Programming Digest 1]]></title>
    <link href="http://mishadoff.github.com/blog/programming-digest-1/"/>
    <updated>2013-02-12T02:00:00+02:00</updated>
    <id>http://mishadoff.github.com/blog/programming-digest-1</id>
    <content type="html"><![CDATA[<p>How to get job at Google, estimate complexity of your algorithm,
what is <em>Structural Immutability</em>, why PHP is awful and Java is awesome, best programming jokes and lot more.</p>

<!-- more -->

<h3 id="get-that-job-at-googlehttpsteve-yeggeblogspotcom200803get-that-job-at-googlehtml">1. <a href="http://steve-yegge.blogspot.com/2008/03/get-that-job-at-google.html">Get that job at Google</a></h3>

<blockquote>
  <p>…it’s highly likely that someone on the loop will be unimpressed with you,
even if you are Alan Turing. Especially if you’re Alan Turing,
in fact, since it means you obviously don’t know C++</p>
</blockquote>

<p>The quote accurately explains what this post about. The author gives great mental and
technical tips about interviewing process (not only in Google).
Big portion of motivation guaranteed, perhaps you man feel dumber after reading.</p>

<p>In few words, you must know: algorithm complexity, sorting, hashtables, trees,
graphs, other data structures, math, operating systems and at least one programming language very well.
Not bad, right? After reading that article I’ve build long-term learning plan for myself, which is still
not succesful. Great article.</p>

<h3 id="a-gentle-introduction-to-algorithm-complexity-analysishttpdiscretegrcomplexity">2. <a href="http://discrete.gr/complexity/">A Gentle Introduction to Algorithm Complexity Analysis</a></h3>

<p>This article helps you partially cover first thing from previous article: <em>algorithm complexity</em>.
By the way, it is written with understandable (<em>for programmers</em>) language, examples, pictures, excerpts - I like
such style.</p>

<p>After reading, you’ll understand what time/space complexity is, difference between <em>Theta</em> and <em>Big-O</em> notations,
recursive functions complexity and lot more. By the way, you will learn basic classes of time complexities, and get
skill to classify that complexities on O(n), O(n^2 ), O(n*logn), etc. Note, the articles consists of some excercises, which immediately followed
with solutions. It is more productive to solve this exercises by yourselves and then compare to solutions.</p>

<p>If you already know all that, don’t skip! It also helpful to fresh you knowledge.</p>

<h3 id="on-structural-immutabilityhttpclojurefunwordpresscom20130121on-structural-immutability">3. <a href="http://clojurefun.wordpress.com/2013/01/21/on-structural-immutability/">On Structural Immutability</a></h3>

<p>What is Structural Immutability?</p>

<p>We know difference between mutable and immutable data structures and their pros and cons.
Structural immutability means that you <em>can</em> change the contents of you data, but <em>can not</em> change their structure.
It gives better performance than plain immutable objects, but also keep your concurrent programs easier than with
full mutability. Plain old array is an example. Read it to know more.</p>

<h3 id="php-a-fractal-of-bad-designhttpmeveekuncomblog20120409php-a-fractal-of-bad-design">4. <a href="http://me.veekun.com/blog/2012/04/09/php-a-fractal-of-bad-design/">PHP: a fractal of bad design</a></h3>

<blockquote>
  <p>Virtually every feature in PHP is broken somehow</p>
</blockquote>

<p>Whole article is a criticism of bad PHP language design.</p>

<blockquote>
  <p>PHP was originally designed explicitly for non-programmers (and, reading between the lines, non-programs)</p>
</blockquote>

<p>Total destroy. I mean it - total.</p>

<blockquote>
  <p>Array… This one datatype acts as a list, ordered hash, ordered set,
sparse list, and occasionally some strange combination of those.
How does it perform? What kind of memory use will there be?
Who knows? Not like I have other options, anyway.</p>
</blockquote>

<p>As I never know PHP, and hope won’t, that article was one of the funniest things I ever read.</p>

<blockquote>
  <p>equality operator is not transitive…comparison is not even consistent</p>
</blockquote>

<p>If you PHPist don’t go away, just read it. Maybe it will change your life.</p>

<blockquote>
  <p>Genericism… There is none. If a function might need to do two slightly different things, PHP just has two functions.</p>
</blockquote>

<p>Stop quoting. Just read it.</p>

<h3 id="do-not-pass-this-way-againhttpgrimoirecamysqlchoose-something-else">5. <a href="http://grimoire.ca/mysql/choose-something-else">Do Not Pass This Way Again</a></h3>

<blockquote>
  <p>Considering MySQL? Use something else. Already on MySQL? Migrate.</p>
</blockquote>

<p>This article logically continues previous one, but for now critisism on MySQL.
Perhaps, it is not powerful as PHP version, but still worth to read.</p>

<h3 id="big-arrays-in-javahttpwwwomsndeblogbig-arrays-in-java">6. <a href="http://www.omsn.de/blog/big-arrays-in-java">Big arrays in Java</a></h3>

<p>Two articles of hate in a row, and currently Java? No way.
How much we hate Java so we love it. By the way, JDK8 is soon.</p>

<p>Maybe this post not so expressive as previous ones, but it reveals capability I never knew of.
How to create array in Java with size greater than <code>Integer.MAX_VALUE</code>. Use the undocumented
class <code>sun.misc.Unsafe</code>. Just note this only works in SunJDK and OpenJDK.</p>

<h3 id="state-of-the-lambdahttpcropenjdkjavanetbriangoetzlambdalambda-state-4html">7. <a href="http://cr.openjdk.java.net/~briangoetz/lambda/lambda-state-4.html">State of the Lambda</a></h3>

<p>If we started about JDK8…</p>

<p>The most interesting feature set in expected JDK8 is Project Lambda.</p>

<p>Functional interfaces and functions without all that finals in lexical scope and anonymous classes,
common patterns for list processing like <code>map</code>, <code>reduce</code> and <code>filter</code>,
parallelism, streams, method references and lot more comming soon.</p>

<p><em>What is the default method implementation in the interface?!</em></p>

<h3 id="fantastic-game-development-tutorials-from-across-the-webhttpgamedevtutspluscomarticlesroundupsfantastic-gamedev-tutorials-from-across-the-web">8. <a href="http://gamedev.tutsplus.com/articles/roundups/fantastic-gamedev-tutorials-from-across-the-web/">40+ Fantastic Game Development Tutorials From Across the Web</a></h3>

<p>Have you ever had the passion to write your own game?</p>

<p>I had. Because I like games and I even tried. Unfortunately, not so succesful as expected, but anyway.</p>

<blockquote>
  <p>We need to go deeper</p>
</blockquote>

<p>Honestly, it’s not a joke that I post link to another digest. It gathers a lot of gamedev tutorials and if
you really interested in gamedev, you’ll find a lot of there including game algorithms,
popular engine tutorials, math behind the games, design questions and more useful tips. Great stuff.</p>

<h3 id="how-to-pair-socks-from-a-pile-efficientlyhttpstackoverflowcomquestions14415881how-to-pair-socks-from-a-pile-efficiently">9. <a href="http://stackoverflow.com/questions/14415881/how-to-pair-socks-from-a-pile-efficiently">How to pair socks from a pile efficiently?</a></h3>

<p>Bored to pair your socks every time? Learn how to do it efficiently.</p>

<p>At first glance it is a humorous question, indeed it is, but also it is an interesting real-world
problem with variety of algorithms can be applied. I think all algorithm courses should be teached
that way.</p>

<h3 id="what-is-your-best-programming-jokehttpstackoverflowcomquestions234075what-is-your-best-programmer-joke1284458">10. <a href="http://stackoverflow.com/questions/234075/what-is-your-best-programmer-joke/1284458">What is your best programming joke</a></h3>

<blockquote>
  <p>If you put a million monkeys at a million keyboards, one of them will eventually write a Java program.</p>

  <p>The rest of them will write Perl programs.</p>
</blockquote>

<p>If you have an hour or two reserved for laughing, just read this. A <strong>lot</strong> of
crazy programming jokes. Stackoverflow community is amazing.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Data Analysis: Facebook Hacker Cup 2013]]></title>
    <link href="http://mishadoff.github.com/blog/data-analysis-facebook-hacker-cup/"/>
    <updated>2013-02-01T12:42:00+02:00</updated>
    <id>http://mishadoff.github.com/blog/data-analysis-facebook-hacker-cup</id>
    <content type="html"><![CDATA[<p>What programming language is most used?</p>

<!-- more -->

<p>To answer this question we use results from the qualification round
of <a href="https://www.facebook.com/hackercup">Facebook Hacker Cup 2013</a></p>

<p>If you only interested in statistics, <a href="#stats">skip!</a></p>

<h3 id="intro">0. Intro</h3>

<p>As you may know, Facebook Hacker Cup is a programming contest. You have programming
problem and you need to solve it, in most cases in efficient way. You get input file
and you need to submit the output file in less than 6 minutes. Pretty simple.
The interesting part you need to submit your source code, that can be reviewed by
any of contestants after round.</p>

<p>These sources we use to get programming language statistics.</p>

<h3 id="data">1. Data</h3>

<p>Primary resource in statistics is data.</p>

<p>We have <a href="https://www.facebook.com/hackercup/scoreboard?round=185564241586420">scoreboard</a> page
(<em>You must be logged to FB to see results</em>) and interested in all links named <em>source</em>.
Open every link manually takes much time, so we will use automated approach
and will write program. Yes, in clojure.</p>

<h4 id="dependencies">Dependencies</h4>

<p>For facebook authentification we can use:</p>

<ul>
  <li><a href="https://github.com/DerGuteMoritz/clj-oauth2">OAuth authentification</a></li>
  <li><a href="https://developers.facebook.com/">Facebook app</a></li>
  <li><a href="http://seleniumhq.org/">Selenium</a></li>
</ul>

<p>I didn’t think too much about alternatives,
because I wanted to try selenium in clojure. It’s a time!</p>

<p>In few words, selenium provides capability to perform programmatically
browser events. Often used in automation. To use selenium in clojure program
just add <code>[clj-webdriver "0.6.0-beta2"]</code> to your project dependencies.</p>

<p>To simplify HTTP GET access we use library <code>[clj-http "0.6.3"]</code> and for
additional help <code>[org.clojure/clojure-contrib "1.2.0"]</code>.</p>

<p>In code we use following <em>requires</em></p>

<p><code>clojure
(:require [clj-http.client :as http])
(:require [clj-webdriver.taxi :as web])
(:require [clj-webdriver.core :as c])
(:require [clojure.contrib.math :as math])
</code></p>

<h4 id="automation">Automation</h4>

<p>Before we will automate actions to gather sources we need to decide
what these actions are?</p>

<ul>
  <li>Run browser</li>
  <li>Open facebook url</li>
  <li>Login to facebook
    <ul>
      <li>Enter login</li>
      <li>Enter password</li>
      <li>Press submit</li>
    </ul>
  </li>
  <li>Go to scoreboard page</li>
  <li>Process each page <code>loop [1..n]</code>
    <ul>
      <li>Go to page <code>n</code></li>
      <li>Get all links</li>
      <li>Filter links with sources</li>
      <li>Process each link <code>loop [1..k]</code>
        <ul>
          <li>Go to link url <code>k</code></li>
          <li>Get all page source</li>
          <li>Filter out source code</li>
          <li>Generate file name</li>
          <li>Write source to file</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>Pretty clear, right? Let’s code it sequentially.</p>

<h4 id="implementation">Implementation</h4>

<ul>
  <li><em>Run browser</em> and <em>Open facebook url</em></li>
</ul>

<p><code>clojure
(web/set-driver! {:browser :firefox} "http://facebook.com")
</code></p>

<ul>
  <li><em>Login to facebook</em></li>
</ul>

<p><code>clojure
(web/input-text "#email" username)
(web/input-text "#pass" password)
(web/submit "#pass")
</code></p>

<ul>
  <li><em>Go to scoreboard page</em></li>
</ul>

<p><code>clojure
(web/to "https://www.facebook.com/hackercup/scoreboard?round=185564241586420")
</code></p>

<ul>
  <li><em>Process each page</em></li>
</ul>

<p><code>clojure
(doseq [page-num (range 1 (inc 114))]
  (process-page page-num))
</code></p>

<p>Number of pages is hardcoded. It’s ok.
What is <code>process-page</code> method?</p>

<p><code>clojure
(defn process-page [n]
  (let [url (str "https://www.facebook.com/hackercup/scoreboard?round=185564241586420&amp;page=" n)]
    (web/to url)
    (doseq [e (web/find-elements {:css "a"})
            :let [url (c/attribute e "href")]
            :when (and url (.startsWith url "https://fbcdn-dragon-a.akamaihd.net/"))]
      (process-url url))))
</code></p>

<p>First of all,  we concat scoreboard link with page number to get actual link to each page.
Then we go to that page obtain all <code>a</code> elements, get their <code>href</code> values and filter
to save only ones that contain source code.</p>

<ul>
  <li><em>Process each url</em></li>
</ul>

<p><code>clojure
(defn process-url [url]
  (let [source-code (:body (http/get url))
        file-name (generate-filename url)]
    (spit file-name source-code)))
</code></p>

<p>In this part we obtain html source of url and get its <code>:body</code> tag.
As all source urls contain just plain text, we don’t need additional
filtering. Just save it to file.</p>

<ul>
  <li><em>Generate file name</em></li>
</ul>

<p>I don’t want to name file as url. That’s why for naming we use following
function: <code>timestamp + underscore + absolute value of url hashcode</code></p>

<p><code>clojure
(defn generate-filename [url]
  (str DIRECTORY (System/currentTimeMillis) "_" (math/abs (hash url)) ".txt"))
</code></p>

<p><code>DIRECTORY</code> is just <code>def</code> for folder where you want to place all sources.</p>

<p>Whole script source available <a href="https://github.com/mishadoff/clj-statistic-tools/blob/master/src/clj_statistic_tools/fbhackercup2013.clj">here</a></p>

<h4 id="execution">Execution</h4>

<p>To run that script you need to write in clojure REPL
<code>(run "username" "password")</code>, with correct values for <em>username</em> and <em>password</em>, obviously.</p>

<p>It works some time. <em>Some time</em> equals to eight hours on my machine. Long enough.
But it’s ideal time for <em>night crawling</em>!</p>

<p>In the morning I had all work done.</p>

<p><code>
ls -1 | wc -l &amp;&amp; du
</code></p>

<p>prints</p>

<p><code>
20348
291120  .
</code></p>

<p>Good sign. We have more than 20K of source codes with total size almost 300Mb.</p>

<h3 id="analysis">2. Analysis</h3>

<p>Data is good. But no one interested in raw data, so we need process it.</p>

<p>Basically, we need to detect programming language by source file.
No extensions.</p>

<p>You can <a href="https://www.bionicspirit.com/blog/2012/02/09/howto-build-naive-bayes-classifier.html">write your own classifier</a>
or use some existing tool.</p>

<p>I did few-minutes research on this topic and found
<a href="https://github.com/github/linguist">linguist</a> project.
It is written in <em>Ruby</em> and used in <a href="https://gist.github.com/">Gist</a> to
detect snippet language. Exactly what we need!</p>

<p><em>Unfortunately, I do not know ruby. I even could not build and run linguist classifier to
detect language in my files. Rvm, gems and modules driving me crazy. I surrendered.</em></p>

<p>Another solution to use javascript library <a href="http://softwaremaniacs.org/soft/highlight/en/">Highlight.js</a>.
It is used in syntax coloring, but have automatic language detection. Again, javascript and
reading files from filesystem… Don’t tell me about Node.js</p>

<p>I decided to write my own “classifier”. Honestly, it’s just regexp matching mechanism
on common language constructions: keywords, imports, most used functions, etc.</p>

<p>Iterative approach has been used.</p>

<p>Select some popular language construction say <code>#include &lt;iostream&gt;</code> and filter it as <code>C</code>. After filtering
we detect some subset of <code>C</code> language, remove them from all files list and repeat again with another construction.</p>

<p><em>I don’t know how <code>C++</code> different from <code>C</code>, so I accept them both as interchangeable languages but call it <code>C/C++</code>.
By the way, <code>C - C++ = 0</code>, so we assume they are equal.</em></p>

<p>I developed some number of patterns (they can be reviewed
<a href="https://github.com/mishadoff/clj-statistic-tools/blob/master/src/clj_statistic_tools/fbhackercup2013.clj">here</a>)
and processed all gathered source files.</p>

<p>Unfortunately, not all files were processed succesfully. I reviewed approximately 2000 files manually, few
new languages were detected but big amount of them were the crap: input data, binary files, some text information.</p>

<p>I think we don’t lose too much if we say <em>only 99% of files were processed</em>.</p>

<h3 id="a-idstatsa3-statistics"><a id="stats"></a>3. Statistics</h3>

<p><img src="http://i.imgur.com/sWyfLqv.png" alt="" /></p>

<p>If you don’t like this visualization, you can create your own. Here is data:</p>

<p><code>
C/C++          10524
Java            3117
Python          3102
C#              1233
PHP              821
Ruby             488
Perl             142
Pascal/Delphi    136
Javascript       109
Haskell           85
Scala             72
Clojure           29
Go                28
Visual Basic      19
F#                12
Scheme             8
OCaml              7
Common Lisp        6
Lua                5
Matlab             4
Cocoa              3
Groovy             2
Dart               2
awk                1
Powershell         1
bash               1
Kotlin             1
ActionScript       1
Dylan              1
--------------------
crap             192
not detected     196
--------------------
TOTAL          20348
</code></p>

<h3 id="conclusion">4. Conclusion</h3>

<ul>
  <li>Top 5 was predicted but it’s extremely crazy that C/C++ occur more than 50%</li>
  <li>Python has almost the same amount as Java</li>
  <li>Good occurence of functional languages: Haskell, F#, Scala, Clojure, Ocaml</li>
  <li>29 Clojure files that means there ~10 clojurists.</li>
  <li>Two languages I never heard of:
<a href="http://www.dartlang.org/">Dart</a> and
<a href="http://opendylan.org/">Dylan</a></li>
  <li><em>Parenthesis</em> languages still used: Common Lisp, Scheme and Clojure (of course)</li>
  <li>Respect to matlabists</li>
  <li>Few <em>exotic languages</em> used: awk, powershell, bash</li>
  <li><a href="http://kotlin.jetbrains.org/">Kotlin</a> becomes popular!</li>
</ul>

<p><em>Warning:</em> Do not treat this statistics as real-world pattern. It is a programming competition with
a lot of geeks, they can use all they want. Also do not blame their code for quality. It was created just for
correctness and speed. Pay attention to code quality in production, but always remember:</p>

<blockquote>
  <p>Your code may be elegant, by mine fucking works.</p>

  <p>– <a href="http://omniti.com/seeds/your-code-may-be-elegant">Leon Fayer</a>
<br /></p>
</blockquote>

<p><strong>P.S.</strong> First of all, it is not high-accurate statistics. As I am not
programming guru, I don’t know all possible languages’ constructions
so it is likely that one construction overlapped with another. In that case
only first one will be checked. Ideally, would be good to have language
detecting library in clojure for future analysis. <em>Maybe</em>, I will do it.
Second of all, code presented here is not beautiful, not optimized, have a lot
of hardcode, but it works. Just in the spirit of Facebook Hacker Cup.</p>
]]></content>
  </entry>
  
</feed>
