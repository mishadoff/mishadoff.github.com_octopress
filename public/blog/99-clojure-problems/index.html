
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>99 Clojure Problems - mishadoff thoughts</title>
  <meta name="author" content="mishadoff">

  
  <meta name="description" content="There is a popular article 99 Prolog Problems that describes
how Prolog solves various small programming problems.
There are couple of remakes in &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mishadoff.github.com/blog/99-clojure-problems/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="mishadoff thoughts" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-36243054-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">mishadoff thoughts</a></h1>
  
    <h2>random thoughts about programming, math and life</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mishadoff.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/categories">Categories</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">99 Clojure Problems</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-11-10T16:20:00+02:00" pubdate data-updated="true">Nov 10<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>There is a popular article <a href="https://sites.google.com/site/prologsite/prolog-problems">99 Prolog Problems</a> that describes
how <a href="http://en.wikipedia.org/wiki/Prolog">Prolog</a> solves various small programming problems.
There are couple of remakes in <a href="http://www.ic.unicamp.br/~meidanis/courses/mc336/2006s2/funcional/L-99_Ninety-Nine_Lisp_Problems.html">Lisp</a>,
<a href="http://aperiodic.net/phil/scala/s-99/">Scala</a>, <a href="http://www.haskell.org/haskellwiki/H-99:_Ninety-Nine_Haskell_Problems">Haskell</a>
and even half-complete in <a href="http://wiki.python.org/moin/ProblemSets/99%20Prolog%20Problems%20Solutions">Python</a>.
I found articles of such type extremely useful for programming language understanding,
as they show solution for common real-world problems.</p>

<p>In this article, codename <strong>CLJ-99</strong>, I provide my solutions to these problems,
reusing as much as possible standard <code>clojure.core</code> and <code>clojure.contrib</code> functions.</p>

<!-- more -->


<p>Some functions will be used with namespace qualifier e.g. <code>sets/union</code> and
corresponding required namespace can be viewed at the namespace requirements.</p>

<h3>Namespace requires</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.contrib.combinatorics</span> <span class="ss">:as</span> <span class="nv">comb</span><span class="p">])</span>
</span><span class='line'><span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.set</span> <span class="ss">:as</span> <span class="nv">sets</span><span class="p">])</span>
</span><span class='line'><span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.contrib.lazy-seqs</span> <span class="ss">:as</span> <span class="nv">lazy</span><span class="p">])</span>
</span><span class='line'><span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.contrib.math</span> <span class="ss">:as</span> <span class="nv">math</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>Solutions will be grouped by topic. To not reinvent wheel, I use the same groups as in original article.</p>

<p>Complexity introduced by stars: * - simple, ** - medium, *** - hard.</p>

<p>Solution for problem is a function, called <code>p</code> plus <code>two digits number</code> representing number of problem.
E.g. <code>p03</code>, <code>p37</code>. Rarely problem will be splitted in two parts, like <code>p34-a</code>, <code>p34-b</code>.</p>

<p>Improvements are very welcome!</p>

<p>Ready? Go!</p>

<h2>Lists</h2>

<h3>P01. (*) Find the last element of a list.</h3>

<p><em>Example:</em>
<code>(p01 [1 2 3 4]) =&gt; 4</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p01</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">last </span><span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P02. (*) Find the last but one element of a list.</h3>

<p><em>Example:</em>
<code>(p02 [1 2 3 4]) =&gt; 3</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p02</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">last </span><span class="p">(</span><span class="nb">butlast </span><span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P03. (*) Find the Kth element of a list.</h3>

<p>The first element in the list is number 1.</p>

<p><em>Example:</em>
<code>(p03 [1 2 3 4] 2) =&gt; 2</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p03</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">k</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">nth </span><span class="nv">lst</span> <span class="p">(</span><span class="nb">dec </span><span class="nv">k</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P04. (*) Find the number of elements of a list.</h3>

<p><em>Example:</em>
<code>(p04 [1 2 3 4]) =&gt; 4</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p04</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">count </span><span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P05. (*) Reverse a list.</h3>

<p><em>Example:</em>
<code>(p05 [1 2 3 4]) =&gt; (4 3 2 1)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p05</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">reverse </span><span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P06. (*) Find out whether a list is a palindrome.</h3>

<p>A palindrome can be read forward or backward; e.g. [x a m a x]</p>

<p><em>Example:</em>
<code>(p06 [1 2 1]) =&gt; true</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p06</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">reverse </span><span class="nv">lst</span><span class="p">)</span> <span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P07. (**) Flatten a nested list structure.</h3>

<p>Transform a list, possibly holding lists as elements into a &#8216;flat&#8217; list by
replacing each list with its elements (recursively).</p>

<p><em>Example:</em>
<code>(p07 [1 [2 [3 4] 2] 1]) =&gt; (1 2 3 4 2 1)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p07</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">flatten</span> <span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P08. (**) Eliminate consecutive duplicates of list elements.</h3>

<p>If a list contains repeated elements they should be replaced with
a single copy of the element. The order of the elements should not be changed.</p>

<p><em>Example:</em>
<code>(p08 [1 1 1 1 2 3 3 1 1 4 5 5 5 5]) =&gt; (1 2 3 1 4 5)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p08</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">map first </span><span class="p">(</span><span class="nf">partition-by</span> <span class="nb">identity </span><span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P09. (**) Pack consecutive duplicates of list elements into sublists.</h3>

<p>If a list contains repeated elements they should be placed in separate sublists.</p>

<p><em>Example:</em>
<code>(p09 [1 1 1 1 2 3 3 1 1 4 5 5 5 5]) = ((1 1 1 1) (2) (3 3) (1 1) (4) (5 5 5 5))</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p09</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">partition-by</span> <span class="nb">identity </span><span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P10. (*) Run-length encoding of a list.</h3>

<p>Use the result of problem P09 to implement the so-called run-length encoding
data compression method. Consecutive duplicates of elements are encoded
as terms [N E] where N is the number of duplicates of the element E.</p>

<p><em>Example:</em>
<code>(p10 [1 1 1 1 2 3 3 1 1 4 5 5 5 5]) =&gt; ((4 1) (1 2) (2 3) (2 1) (1 4) (4 5))</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p10</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="nf">juxt</span> <span class="nb">count </span><span class="nv">first</span><span class="p">)</span> <span class="p">(</span><span class="nf">p09</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P11. (*) Modified run-length encoding.</h3>

<p>Modify the result of problem P10 in such a way that if an element has
no duplicates it is simply copied into the result list.
Only elements with duplicates are transferred as [N E] terms.</p>

<p><em>Example:</em>
<code>(p11 [1 1 1 1 2 3 3 1 1 4 5 5 5 5]) =&gt; ((4 1) 2 (2 3) (2 1) 4 (4 5))</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p11</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nb">first </span><span class="nv">%</span><span class="p">))</span> <span class="p">(</span><span class="nb">second </span><span class="nv">%</span><span class="p">)</span> <span class="nv">%</span><span class="p">)</span> <span class="p">(</span><span class="nf">p10</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P12. (**) Decode a run-length encoded list.</h3>

<p>Given a run-length code list generated as specified in problem P11.
Construct its uncompressed version.</p>

<p><em>Example:</em>
<code>(p12 [[4 1] 2 [2 3] [2 1] 4 [4 5]]) =&gt; (1 1 1 1 2 3 3 1 1 4 5 5 5 5)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p12</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">flatten</span> <span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">coll?</span> <span class="nv">%</span><span class="p">)</span> <span class="p">(</span><span class="nb">repeat </span><span class="p">(</span><span class="nb">first </span><span class="nv">%</span><span class="p">)</span> <span class="p">(</span><span class="nb">second </span><span class="nv">%</span><span class="p">))</span> <span class="nv">%</span><span class="p">)</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P13. (**) Run-length encoding of a list (direct solution).</h3>

<p>Implement the so-called run-length encoding data compression method directly.
I.e. don&#8217;t explicitly create the sublists containing the duplicates,
as in problem P09, but only count them. As in problem P11,
simplify the result list by replacing the singleton terms [1 X] by X.</p>

<p><em>Example:</em>
<code>(p13 [1 1 1 1 2 3 3 1 1 4 5 5 5 5]) =&gt; ((4 1) (1 2) (2 3) (2 1) (1 4) (4 5))</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p13</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">loop </span><span class="p">[[</span><span class="nv">h</span> <span class="o">&amp;</span> <span class="nv">t</span><span class="p">]</span> <span class="nv">lst</span> <span class="nv">prev</span> <span class="p">(</span><span class="nb">first </span><span class="nv">lst</span><span class="p">)</span> <span class="nv">c</span> <span class="mi">0</span> <span class="nv">acc</span> <span class="p">[]]</span>
</span><span class='line'>    <span class="p">(</span><span class="k">if </span><span class="nv">h</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">prev</span> <span class="nv">h</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">recur</span> <span class="nv">t</span> <span class="nv">prev</span> <span class="p">(</span><span class="nb">inc </span><span class="nv">c</span><span class="p">)</span> <span class="nv">acc</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">recur</span> <span class="nv">t</span> <span class="nv">h</span> <span class="mi">1</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">c</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">conj </span><span class="nv">acc</span> <span class="nv">prev</span><span class="p">)</span> <span class="p">(</span><span class="nb">conj </span><span class="nv">acc</span> <span class="p">[</span><span class="nv">c</span> <span class="nv">prev</span><span class="p">]))))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">c</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">conj </span><span class="nv">acc</span> <span class="nv">prev</span><span class="p">)</span> <span class="p">(</span><span class="nb">conj </span><span class="nv">acc</span> <span class="p">[</span><span class="nv">c</span> <span class="nv">prev</span><span class="p">])))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P14. (*) Duplicate the elements of a list.</h3>

<p><em>Example:</em>
<code>(p14 [1 2 3 3 4]) =&gt; (1 1 2 2 3 3 3 3 4 4)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p14</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">interleave </span><span class="nv">lst</span> <span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P15. (**) Duplicate the elements of a list a given number of times.</h3>

<p><em>Example:</em>
<code>(p15 [1 2 3] 3) =&gt; (1 1 1 2 2 2 3 3 3)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p15</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">k</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">mapcat </span><span class="o">#</span><span class="p">(</span><span class="nb">repeat </span><span class="nv">k</span> <span class="nv">%</span><span class="p">)</span> <span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P16. (**) Drop every Nth element from a list.</h3>

<p><em>Example:</em>
<code>(p16 [1 2 3 4 5 6 7 8 9 0] 3) =&gt; (1 2 4 5 7 8 0)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p16</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">flatten</span> <span class="p">(</span><span class="nf">partition-all</span> <span class="p">(</span><span class="nb">dec </span><span class="nv">n</span><span class="p">)</span> <span class="nv">n</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P17. (*) Split a list into two parts; the length of the first part is given.</h3>

<p><em>Example:</em>
<code>(p17 [1 2 3 4 5 6 7 8 9 0] 3) =&gt; ((1 2 3) (4 5 6 7 8 9 0))</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p17</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">split-at </span><span class="nv">n</span> <span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P18. (**) Extract a slice from a list.</h3>

<p>Given two indices, <code>N</code> and <code>K</code>, the slice is the list containing the elements
between the Nth and Kth element of the original list (both limits included).
Start counting the elements with 1.</p>

<p><em>Example:</em>
<code>(p18 [1 2 3 4 5 6 7 8 9 0] 3 7) =&gt; (3 4 5 6 7)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p18</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">n</span> <span class="nv">k</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">take </span><span class="p">(</span><span class="nb">inc </span><span class="p">(</span><span class="nb">- </span><span class="nv">k</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">drop </span><span class="p">(</span><span class="nb">dec </span><span class="nv">n</span><span class="p">)</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P19. (**) Rotate a list N places to the left.</h3>

<p><em>Example:</em>
<code>(p19 [1 2 3 4 5 6 7] 3) =&gt; (4 5 6 7 1 2 3)</code></p>

<p><em>Example:</em>
<code>(p19 [1 2 3 4 5 6 7] -1) =&gt; (7 1 2 3 4 5 6)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p19</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">k</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">pos? </span><span class="nv">n</span><span class="p">)</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="p">(</span><span class="nb">count </span><span class="nv">lst</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">split-at </span><span class="nv">k</span> <span class="nv">lst</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">concat </span><span class="nv">b</span> <span class="nv">a</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P20. (**) Remove the Kth element from a list.</h3>

<p><em>Example:</em>
<code>(p20 [1 2 3 4] 2) =&gt; (1 3 4)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p20</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">k</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">concat </span><span class="p">(</span><span class="nb">take </span><span class="p">(</span><span class="nb">dec </span><span class="nv">k</span><span class="p">)</span> <span class="nv">lst</span><span class="p">)</span> <span class="p">(</span><span class="nb">drop </span><span class="nv">k</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P21. (**) Insert an element at a given position into a list.</h3>

<p><em>Example:</em>
<code>(p21 100 [1 2 3 4] 2) =&gt; (1 100 2 3 4)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p21</span> <span class="p">[</span><span class="nv">e</span> <span class="nv">lst</span> <span class="nv">k</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">concat </span><span class="p">(</span><span class="nb">take </span><span class="p">(</span><span class="nb">dec </span><span class="nv">k</span><span class="p">)</span> <span class="nv">lst</span><span class="p">)</span> <span class="p">(</span><span class="nb">list </span><span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nb">drop </span><span class="p">(</span><span class="nb">dec </span><span class="nv">k</span><span class="p">)</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P22. (*) Create a list containing all integers within a given range.</h3>

<p><em>Example:</em>
<code>(p22 4 9) =&gt; (4 5 6 7 8 9)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p22</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">range </span><span class="nv">a</span> <span class="p">(</span><span class="nb">inc </span><span class="nv">b</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P23. (**) Extract a given number of randomly selected elements from a list.</h3>

<p>The selected items shall be put into a result list.</p>

<p><em>Example:</em>
<code>(p23 [1 2 3 4 5 6 7 8] 3) =&gt; (3 7 2)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p23</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">k</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">take </span><span class="nv">k</span> <span class="p">(</span><span class="nf">shuffle</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P24. (**) Lotto: Draw N different random numbers from the set 1..N</h3>

<p>The selected numbers shall be put into a result list.</p>

<p><em>Example:</em>
<code>(p24 6 49) =&gt; (23 1 17 33 21 27)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p24</span> <span class="p">[</span><span class="nv">k</span> <span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">take </span><span class="nv">k</span> <span class="p">(</span><span class="nf">shuffle</span> <span class="p">(</span><span class="nb">range </span><span class="mi">1</span> <span class="p">(</span><span class="nb">inc </span><span class="nv">n</span><span class="p">)))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P25. (*) Generate a random permutation of the elements of a list.</h3>

<p><em>Example:</em>
<code>(p25 [1 2 3 4 5 6]) =&gt; (3 6 1 5 2 4)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p25</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">shuffle</span> <span class="nv">lst</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P26. (**) Generate the combinations of K distinct objects chosen from the N elements of a list</h3>

<p>In how many ways can a committee of 3 be chosen from a group of 12 people?
We all know that there are C(12,3) = 220 possibilities
(C(N,K) denotes the well-known binomial coefficients).
For pure mathematicians, this result may be great.
But we want to really generate all the possibilities (via backtracking).</p>

<p><em>Example:</em>
<code>(p26 [1 2 3 4 5 6] 3) = [[1 2 3] [1 2 4] ... [4 5 6]]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p26</span> <span class="p">[</span><span class="nv">lst</span> <span class="nv">k</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">comb/combinations</span> <span class="nv">lst</span> <span class="nv">k</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P27. (**) Group the elements of a set into disjoint subsets.</h3>

<p>a) In how many ways can a group of 9 people work in 3 disjoint subgroups
of 2, 3 and 4 persons? Write a predicate that generates
all the possibilities via backtracking.</p>

<p><em>Example:</em>
<code>(p27-a #{:a :b :c :d :e :f :g :h :i}) =&gt; [[#{:a :b} #{:c :d :e} #{:f :g :h :i}] ...]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p27-a</span> <span class="p">[</span><span class="nv">st</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">fg</span> <span class="p">(</span><span class="nf">comb/combinations</span> <span class="nv">st</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">sg</span> <span class="p">(</span><span class="nf">comb/combinations</span> <span class="p">(</span><span class="nb">remove </span><span class="o">#</span><span class="p">(</span><span class="nb">contains? </span><span class="p">(</span><span class="nb">set </span><span class="nv">fg</span><span class="p">)</span> <span class="nv">%</span><span class="p">)</span> <span class="nv">st</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span>
</span><span class='line'>        <span class="ss">:let</span> <span class="p">[</span><span class="nv">lg</span> <span class="p">(</span><span class="nb">remove </span><span class="o">#</span><span class="p">(</span><span class="nb">contains? </span><span class="p">(</span><span class="nf">sets/union</span> <span class="p">(</span><span class="nb">set </span><span class="nv">sg</span><span class="p">)</span> <span class="p">(</span><span class="nb">set </span><span class="nv">fg</span><span class="p">))</span> <span class="nv">%</span><span class="p">)</span> <span class="nv">st</span><span class="p">)]]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">map set </span><span class="p">[</span><span class="nv">fg</span> <span class="nv">sg</span> <span class="nv">lg</span><span class="p">])))</span>
</span></code></pre></td></tr></table></div></figure>


<p>b) Generalize the above predicate in a way that we can specify a list
of group sizes and the predicate will return a list of groups.</p>

<p><em>Example:</em>
<code>(p27-b #{:a :b :c :d :e :f :g :h :i} [2 2 5]) =&gt; [[#{:a :b} {:c :d} {:e :f :g :h :i}] ...]</code></p>

<p><strong>Note:</strong> that we do not want permutations of the group members; i.e.
[[:a :b] &#8230;] is the same solution as [[:b :a] &#8230;].
However, we make a difference between [[:a :b] [:c :d] &#8230;] and
[[:c :d] [:a :b] &#8230;].</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p27-b</span> <span class="p">[</span><span class="nv">st</span> <span class="nv">groups</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">n</span> <span class="p">(</span><span class="nb">count </span><span class="nv">groups</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">f-rec</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">st</span> <span class="nv">groups</span><span class="p">]</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nb">count </span><span class="nv">groups</span><span class="p">))</span> <span class="p">[[</span><span class="nv">st</span><span class="p">]]</span>
</span><span class='line'>                      <span class="ss">:else</span> <span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nv">g1</span> <span class="o">&amp;</span> <span class="nv">gs</span><span class="p">]</span> <span class="nv">groups</span>
</span><span class='line'>                                  <span class="nv">fg</span> <span class="p">(</span><span class="nf">comb/combinations</span> <span class="nv">st</span> <span class="nv">g1</span><span class="p">)]</span>
</span><span class='line'>                              <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">f</span> <span class="nv">fg</span><span class="p">]</span>
</span><span class='line'>                                <span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">set </span><span class="nv">f</span><span class="p">)</span> <span class="nv">%</span><span class="p">)</span>
</span><span class='line'>                                     <span class="p">(</span><span class="nf">p27-b</span> <span class="p">(</span><span class="nf">sets/difference</span> <span class="nv">st</span> <span class="p">(</span><span class="nb">set </span><span class="nv">f</span><span class="p">))</span> <span class="nv">gs</span><span class="p">))))))]</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">partition</span> <span class="nv">n</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">flatten</span> <span class="p">(</span><span class="nf">f-rec</span> <span class="nv">st</span> <span class="nv">groups</span><span class="p">)))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P28. (**) Sorting a list of lists according to length of sublists.</h3>

<p>a) We suppose that a list contains elements that are lists themselves.
The objective is to sort the elements of top list according to their length.
E.g. short lists first, longer lists later, or vice versa.</p>

<p><em>Example:</em>
<code>(p28-a [[:a :b :c] [:d :e] [:f :g :h] [:d :e] [:i :j :k :l] [:m :n] [:o]]) =&gt; [[:o] [:d :e] [:d :e] [:m :n] [:a :b :c] [:f :g :h] [:i :j :k :l]]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p28-a</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">reverse </span><span class="p">(</span><span class="nb">sort-by count </span><span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<p>b) Again, we suppose that a list contains elements that are lists themselves.
But this time the objective is to sort the elements of top list according
to their length frequency; i.e. in the default, where sorting is done ascendingly,
lists with rare lengths are placed first, others with a more frequent length come later.</p>

<p><em>Example:</em>
<code>(p28-b [[:a :b :c] [:d :e] [:f :g :h] [:d :e] [:i :j :k :l] [:m :n] [:o]]) =&gt; [[:i :j :k :l] [:o] [:a :b :c] [:f :g :h] [:d :e] [:d :e] [:m :n]]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p28-b</span> <span class="p">[</span><span class="nv">lst</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">freqs</span> <span class="p">(</span><span class="nf">frequencies</span> <span class="p">(</span><span class="nb">map count </span><span class="nv">lst</span><span class="p">))]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">sort-by </span><span class="o">#</span><span class="p">(</span><span class="nb">get </span><span class="nv">freqs</span> <span class="p">(</span><span class="nb">count </span><span class="nv">%</span><span class="p">))</span> <span class="nv">lst</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Arithmetic</h2>

<h3>P29. (**) Determine whether a given integer number is prime.</h3>

<p><em>Example:</em>
<code>(p29 7) =&gt; true</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p29</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nb">drop-while </span><span class="o">#</span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">%</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">lazy/primes</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P30. (**) Determine the prime factors of a given positive integer.</h3>

<p>Construct a flat list containing the prime factors in ascending order.</p>

<p><em>Example:</em>
<code>(p30 315) =&gt; [3 3 5 7]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p30</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">loop </span><span class="p">[[</span><span class="nv">p</span> <span class="o">&amp;</span> <span class="nv">ps</span><span class="p">]</span> <span class="nv">lazy/primes</span> <span class="nv">num</span> <span class="nv">n</span> <span class="nv">fact</span> <span class="p">[]]</span>
</span><span class='line'>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="nv">num</span><span class="p">)</span> <span class="nv">fact</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">mod</span> <span class="nv">num</span> <span class="nv">p</span><span class="p">))</span> <span class="p">(</span><span class="nf">recur</span> <span class="nv">lazy/primes</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">num</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">conj </span><span class="nv">fact</span> <span class="nv">p</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">recur</span> <span class="nv">ps</span> <span class="nv">num</span> <span class="nv">fact</span><span class="p">)))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P31. (**) Determine the prime factors of a given positive integer (2).</h3>

<p>Construct a list containing the prime factors and their multiplicity.</p>

<p><em>Example:</em>
<code>(p31 315) =&gt; [[3 2] [5 1] [7 1]]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p31</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="nf">juxt</span> <span class="nb">first </span><span class="nv">count</span><span class="p">)</span> <span class="p">(</span><span class="nf">partition-by</span> <span class="nb">identity </span><span class="p">(</span><span class="nf">p30</span> <span class="nv">n</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P32. (*) A list of prime numbers.</h3>

<p>Given a range of integers by its lower and upper limit, construct a list of all prime numbers in that range.</p>

<p><em>Example:</em>
<code>(p32 10 20) =&gt; (11 13 17 19)</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p32</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">take-while </span><span class="o">#</span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">%</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nb">drop-while </span><span class="o">#</span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">%</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">lazy/primes</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P33. (**) Goldbach&#8217;s conjecture.</h3>

<p>Goldbach&#8217;s conjecture says that every positive even number greater than 2 is the sum of two prime numbers.
Example: 28 = 5 + 23. It is one of the most famous facts in number theory that has not been proved
to be correct in the general case. It has been numerically confirmed up to very large numbers.
Write a predicate to find the two prime numbers that sum up to a given even integer.</p>

<p><em>Example:</em>
<code>(p33 28) =&gt; [5 23]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p33</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">ps</span> <span class="p">(</span><span class="nb">take-while </span><span class="o">#</span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">%</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">lazy/primes</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">i</span> <span class="nv">ps</span> <span class="nv">j</span> <span class="nv">ps</span> <span class="ss">:when</span> <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">+ </span><span class="nv">i</span> <span class="nv">j</span><span class="p">)</span> <span class="nv">n</span><span class="p">)]</span>
</span><span class='line'>             <span class="p">[</span><span class="nv">i</span> <span class="nv">j</span><span class="p">]))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P34. (**) A list of Goldbach compositions.</h3>

<p>a) Given a range of integers by its lower and upper limit, print a list of all even numbers
and their Goldbach composition.</p>

<p><em>Example:</em>
<code>(p34-a 9 20) =&gt; [[10 3 7] [12 5 7] [14 3 11] [16 3 13] [18 5 13] [20 3 17]]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p34-a</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">i</span> <span class="p">(</span><span class="nb">range </span><span class="nv">a</span> <span class="p">(</span><span class="nb">inc </span><span class="nv">b</span><span class="p">))</span> <span class="ss">:when</span> <span class="p">(</span><span class="nf">even?</span> <span class="nv">i</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">i</span> <span class="p">(</span><span class="nf">p33</span> <span class="nv">i</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<p>b) In most cases, if an even number is written as the sum of two prime numbers,
one of them is very small. Very rarely, the primes are both bigger than say 50.
Try to find out how many such cases there are in the range 3..2000.</p>

<p><em>Example:</em>
<code>(p34-b 3 2000 50) =&gt; [[992 73 919] [1382 61 1321] [1856 67 1789] [1928 61 1867]]</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p34-b</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">limit</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">for </span><span class="p">[[</span><span class="nv">q</span> <span class="nv">w</span> <span class="nv">e</span><span class="p">]</span> <span class="p">(</span><span class="nf">p34-a</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="ss">:when</span> <span class="p">(</span><span class="nb">and </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">w</span> <span class="nv">limit</span><span class="p">)</span> <span class="p">(</span><span class="nb">&gt; </span><span class="nv">e</span> <span class="nv">limit</span><span class="p">))]</span>
</span><span class='line'>    <span class="p">[</span><span class="nv">q</span> <span class="nv">w</span> <span class="nv">e</span><span class="p">]))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P35. (**) Determine the greatest common divisor of two positive integer numbers.</h3>

<p><em>Example:</em>
<code>(p35 36 63) =&gt; 9</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p35</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">math/gcd</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P36. (**) Determine whether two positive integer numbers are coprime.</h3>

<p>Two numbers are coprime if their greatest common divisor equals 1.</p>

<p><em>Example:</em>
<code>(p36 35 64) =&gt; true</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p36</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">p35</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P37. (**) Calculate Euler&#8217;s totient function phi(m).</h3>

<p>Euler&#8217;s so-called totient function <code>phi(m)</code> is defined as the number of positive integers
<code>r</code> in range <code>1 &lt;= r &lt; m</code> that are coprime to <code>m</code>.</p>

<p><em>Example:</em>
<code>(p37 10) =&gt; 4</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p37</span> <span class="p">[</span><span class="nv">m</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">reduce + </span><span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">r</span> <span class="p">(</span><span class="nb">range </span><span class="mi">1</span> <span class="nv">m</span><span class="p">)]</span>
</span><span class='line'>              <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">p36</span> <span class="nv">r</span> <span class="nv">m</span><span class="p">)</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P38. (**) Calculate Euler&#8217;s totient function phi(m). (2)</h3>

<p>See problem P37 for the definition of Euler&#8217;s totient function.
If the list of the prime factors of a number m is known in the form of problem P31
then the function <code>phi(m)</code> can be efficiently calculated as follows:</p>

<p>Let [[p1 m1] [p2 m2] [p3 m3] &#8230;] be the list of prime factors (and their multiplicities)
of a given number <code>m</code>. Then <code>phi(m)</code> can be calculated with the following formula:</p>

<p><code>phi(m) = (p1 - 1) * p1^(m1 - 1) * (p2 - 1) * p2^(m2 - 1) * (p3 - 1) * p3^(m3 - 1) * ...</code></p>

<p><em>Example:</em>
<code>(p38 10) =&gt; 4</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p38</span> <span class="p">[</span><span class="nv">m</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">reduce * </span><span class="p">(</span><span class="nb">for </span><span class="p">[[</span><span class="nv">p</span> <span class="nv">m</span><span class="p">]</span> <span class="p">(</span><span class="nf">p31</span> <span class="nv">m</span><span class="p">)]</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">dec </span><span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">math/expt</span> <span class="nv">p</span> <span class="p">(</span><span class="nb">dec </span><span class="nv">m</span><span class="p">))))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>P39. (**) Compare the two methods of calculating Euler&#8217;s totient function.</h3>

<p>Compare result and execution time.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">p39</span> <span class="p">[</span><span class="nv">m</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">println </span><span class="s">&quot;1st implementation: p37 =&gt;&quot;</span> <span class="p">(</span><span class="nb">time </span><span class="p">(</span><span class="nf">p37</span> <span class="nv">m</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">println </span><span class="s">&quot;2nd implementation: p38 =&gt;&quot;</span> <span class="p">(</span><span class="nb">time </span><span class="p">(</span><span class="nf">p38</span> <span class="nv">m</span><span class="p">)))))</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Logic and Codes</h2>

<h3>P40. (**) Truth tables for logical expressions.</h3>

<p>Define binary predicates <code>and</code>, <code>or</code>, <code>nand</code>, <code>nor</code>, <code>xor</code>, <code>impl</code> and <code>equ</code> (for logical equivalence)
and build truth table for passed expression.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">mishadoff</span></span>

      








  


<time datetime="2012-11-10T16:20:00+02:00" pubdate data-updated="true">Nov 10<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/clojure/'>clojure</a>, <a class='category' href='/blog/categories/programming/'>programming</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://mishadoff.github.com/blog/99-clojure-problems/" data-via="mishadoff" data-counturl="http://mishadoff.github.com/blog/99-clojure-problems/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/clojure-euler-problem-005/" title="Previous Post: Clojure Euler: Problem 005">&laquo; Clojure Euler: Problem 005</a>
      
      
        <a class="basic-alignment right" href="/blog/learn-perl/" title="Next Post: Learn Perl">Learn Perl &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/programming-digest-1/">Programming Digest 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/programming-digest-announcement/">Programming Digest Announcement</a>
      </li>
    
      <li class="post">
        <a href="/blog/clojure-euler-problem-014/">Clojure Euler: Problem 014</a>
      </li>
    
      <li class="post">
        <a href="/blog/data-analysis-facebook-hacker-cup/">Data Analysis: Facebook Hacker Cup 2013</a>
      </li>
    
      <li class="post">
        <a href="/blog/clojure-euler-problem-013/">Clojure Euler: Problem 013</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Pages</h1>
  <ul id="pages_static">
      <li><a href="/pages/quotes">Quotes</a></li>
      <li><a href="/pages/clojure-links">Clojure Links</a></li>
  </ul>
</section>



<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("mishadoff", 3, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/mishadoff" class="twitter-follow-button" data-show-count="false">Follow @mishadoff</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - mishadoff -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mits';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mishadoff.github.com/blog/99-clojure-problems/';
        var disqus_url = 'http://mishadoff.github.com/blog/99-clojure-problems/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
